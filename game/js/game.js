const songs = [
	{
    id: "glue",
		title: "Glue Song (feat Clario)",
		lyrics:
			"I've never known someone like you,Tangled in love, stuck by you, from the glue Don't forget to kiss me or else you'll have to miss me I guess I'm stuck forever by the glue, oh, and you",
      file: "songs/Glue Song (feat. Clairo).mp3",
     photo: "",
	},
	{

    id: "smile",
		title: "Die With a Smile",
		lyrics:
			"If the world was ending, I'd wanna be next to you If the party was over and our time on Earth was through I'd wanna hold you just for a while and die with a smile If the world was ending, I'd wanna be next to you",
		file: "songs/Lady Gaga, Bruno Mars - Die With A Smile (Official Audio).mp3",
	},
	{
    id: "feeling",
		title: "I've Got A Feeling - The Beatles",
		lyrics:
			"I've got a feeling, a feeling deep inside, oh yeah. Oh yeah. That's right. I've got a feeling, a feeling I can't hide, oh no. Oh no! Oh no. Yeah! Yeah! I've got a feeling. Oh please believe me, I'd hate to miss the train, oh yeah, yeah, oh yeah. And if you leave me, I won't be late again, oh no. Oh no! Oh no! Oh no. Yeah, yeah! I've got a feeling.  I've got a feeling. All these years I've been wandering around, wondering how come nobody told me all that I was looking for was somebody who looked like you!  I've got a feeling that keeps me on my toes, oh yeah.  Oh yeah!  I've got a feeling, I think that everybody knows, oh yeah, oh yeah! Oh yeah! Yeah! I've got a feeling yeah! Everybody had a hard year. Everybody had a good time. Everybody had a wet dream. Everybody saw the sunshine. Oh yeah, oh yeah, oh yeah. Everybody had a good year. Everybody let their hair down. Everybody pulled their socks up, yeah. Everybody put their foot down, oh yeah. I've got a feeling, a feeling deep inside, oh yeah.  Everybody had a wet dream, oh yeah. Everybody saw the sunshine. I've got a feeling, a feeling I can hide, oh no. Everybody pulled their socks up, oh no no. Everybody put their foot down, oh! Yeah! I've got a feeling. I've got a feeling, oh yeah. I've got a feeling.  ",
		file: "videos/I'VE A GOT A FEELING TAKE 1 ï½œ THE BEATLES ROOFTOP CONCERT.mp4",
    videoSize: "575px"
	},
	{
    id: "nature",
		title: "Child of Nature (Esher Demo) - The Beatles",
		lyrics: 
      "On the road to Rishikesh, I was dreaming more or less. And the dream I had was true, yes the dream I had was true.  I'm just a child of nature, I don't need much to set me free.",
		file: "songs/Child Of Nature (Esher Demo).mp3",
		photo: "images/ontheroad.jpg",
    photoSize: "500px"
	},
	{
    id: "forget",
		title: "Forget Her - Jeff Buckley",
		lyrics:
			"While this town is busy sleeping, all the noise has died away, I walk the streets to stop my weeping cause she will never change her way. But don't fool yourself, she was heartache from the moment that you met her. Ah, my heart feels so still as I try to find the will To forget her somehow. Oh, I think I've forgotten her now.",
		file: "songs/Jeff Buckley - Forget Her.mp3",
		photo: "img/jeff-buckley.jpg",
  
	},
  {
    id: "what",
    title: "What Ever Happened - The Strokes",
    lyrics: 
     "I wanna be forgotten and I don't wanna be reminded. You say please don't make this harder. No I won't yet.  I wanna be beside her. She wanna be admired, you say please don't make this harder. No I won't yet. Oh dear is it really all true? Did they offend us and they want it to sound true? Top ten ideas for countdown shows, whose culture is this and does anybody know? I wait and tell myself, life ain't chess, but no one comes in and yes, you're alone. You don't miss me, I know. Oh Tennessee what did you write? ",
    file: "songs/What Ever Happened_.mp3",
    photo: "images/strokes2.jpg",
    photoSize: "610px",
  }, 
  {
  id: "everything",
  title: "Everything She Wants - Wham!",
  lyrics: "Ah ha ha. Oh yeah. Work. Somebody told me, boy everything she wants is everything she sees. I guess I must've loved you because I said you were the perfect girl for me, baby. And now we're six months older and everything you want and everything you see, is out of reach not good enough. I don't know what the hell you want from me, oh. Somebody tell me, won't you tell me, why I work so hard for you. Give you money, work to give you money.",
  file: "songs/Everything She Wants.mp3",
  photo: "images/wp4296903-wham-wallpapers.jpg",
  photoSize: "610px",
  },

  {
  id: "paperback",
  title: "Paperback Writer - The Beatles",
  lyrics: "Paperback writer. Dear Sir or Madam will you read my book, it took me years to write will you take a look? It's based on a novel by a man named Lear and I need a job so I wanna be a paperback writer, paperback writer. It's a dirty story of a dirty man and his clinging wife doesn't understand. His son is working for the Daily Mail, it's a steady job but he wants to be a paperback writer, paperback writer.",
  file: "videos/The Beatles - Paperback Writer.mp4",
  videoSize: "800px",
 
  },

  { 
  id: "rain",
  title: "Rain - The Beatles",
  lyrics: "When the rain comes, they run and hide their heads.",
  file: "videos/The Beatles - Rain.mp4",
  videoSize: "800px",
  },

  {
  id: "fake",
  title: "Fake Tales of San Francisco - Arctic Monkeys",
  lyrics: "Fake tales of San Francisco echo through the room.",
  file: "videos/Arctic Monkeys - Fake Tales Of San Francisco (Official Video).mp4",
  videoSize: "800px"

  },

  {
  id: "darkness",
  title: "Under Cover of Darkness - The Strokes",
  lyrics: "Slip back outta whack at your best, it's a nightmare.",
  file: "videos/The Strokes - Under Cover of Darkness (Official Video).mp4",
  videoSize: "800px"

  }, 

  { 
  id: "fell",
  title: "If I Fell - The Beatles", 
  lyrics: "If I fell in love with you would you promise to be true and help me understand. Cause I've been in love before and I found that love was more than just holding hands. If I gave my heart to you I must be sure from the very start that you would love me more than her. If trust in you oh please don't run and hide. If I love you too oh please don't hurt my pride like her cause I couldn't stand the pain and I would be sad if our new love was in vain. So I hope you see that I would love to love you and that she will cry when she learns we are two cause I couldn't stand the pain and I would be sad if our new love was in vain. So I hope you see that I would love to love you and that she will cry when she learns we are two. If I fell in love with you...",
  file: "songs/If I Fell (Remastered 2009).mp3",
  photo: "images/ififell.jpeg",
  photoSize: "550px"

  }, 
  {
  id: "nowhere",
  title: "Nowhere Man - The Beatles",
  lyrics: "He's a real nowhere man sitting in his nowhere land making all his nowhere plans for nobody. Doesn't have a point of view knows not where he's going to isn't he a bit like you and me? Nowhere man please listen you don't know what you're missing nowhere man the world is at your command. He's as blind as he can be jsut sees what he wants to see Nowhere man can you see me at all?",
  file: "songs/Nowhere Man (Remastered 2009).mp3",
  photo: "images/umbrellabeatles.jpg",
  photoSize: "700px"
  }




];

let currentIndex = 0;

function renderLyrics(lyrics) {
  const container = document.getElementById("lyrics-display");
  container.innerHTML = "";

  for (let char of lyrics) {
    const span = document.createElement("span");
    span.innerHTML = char === " " ? "&nbsp;" : char;
    container.appendChild(span);
  }
}


function loadSongByIndex(index) {
  if (index < 0 || index >= songs.length) {
    console.warn("Invalid song index:", index);
    return;
  }
  currentIndex = 0;
  const song = songs[index];
  
  // You can just call loadSong here
  loadSong(song);
}

function updateCursor() {
  const spans = document.querySelectorAll("#lyrics-display span");
  spans.forEach(span => span.classList.remove("cursor"));

  if (currentIndex < spans.length) {
    spans[currentIndex].classList.add("cursor");
    spans[currentIndex].scrollIntoView({
      behavior: "smooth",
      inline: "center",
      block: "nearest"
    });
  }
}

window.addEventListener("DOMContentLoaded", () => {
	const urlParams = new URLSearchParams(window.location.search);

  const songId = urlParams.get("song");

if (songId) {
  const song = songs.find(s => s.id === songId);
  if (song) {
    loadSong(song);
  } else {
    console.warn("Song not found for id:", songId);
  }
} else {
  // fallback to random song
  loadSong(songs[Math.floor(Math.random() * songs.length)]);
}

function loadSong(song) {
  const player = document.getElementById("player");

  if (!song.file) {
    player.pause();
    player.removeAttribute("src");
    player.style.display = "none";
    player.load();
    return;
  }

  const isAudio = song.file.toLowerCase().endsWith(".mp3");

  player.pause();
  player.src = song.file;
  player.load();

  if (isAudio) {
    player.style.display = "block";
    player.style.width = song.fileSize || "300px";
    player.style.height = "30px";
    player.style.maxWidth = "none";
  } else {
    player.style.display = "block";
    player.style.width = "100%";
    player.style.height = "auto";
    player.style.maxWidth = song.videoSize || "700px";
  }

  player.play();

  $("#song-title").css("text-align", "center");

  $("#song-title").html("<h2>" + song.title + "</h2>");
  $("#typing-container").css("display", "block");

  if (song.photo) {
    $("#song-photo")
      .attr("src", song.photo)
      .css("max-width", song.photoSize || "450px")
      .show();
  } else {
    $("#song-photo").hide();
  }

  renderLyrics(song.lyrics);
  updateCursor();

  $("#lyrics-display").focus();


}

	$("#lyrics-display").on("keydown", handleTyping);

  function handleTyping(event) {
    const lyricsSpans = document.querySelectorAll("#lyrics-display span");
    if (currentIndex >= lyricsSpans.length) return;
  
    const expectedChar = lyricsSpans[currentIndex].textContent;
    const typedChar = event.key;
  
    if (event.ctrlKey || event.altKey || event.metaKey) return;
    if (typedChar.length !== 1 && event.key !== "Backspace") return;
  
    if (event.key === "Backspace") {
      if (currentIndex > 0) {
        currentIndex--;
        lyricsSpans[currentIndex].classList.remove("correct", "incorrect");
      }
      event.preventDefault();
      updateCursor();
      updateProgress();
      return;
    }
  
    if (typedChar === expectedChar) {
      lyricsSpans[currentIndex].classList.add("correct");
      lyricsSpans[currentIndex].classList.remove("incorrect");
    } else {
      lyricsSpans[currentIndex].classList.add("incorrect");
      lyricsSpans[currentIndex].classList.remove("correct");
    }
  
    currentIndex++;
    updateCursor();
    updateProgress();
  
    event.preventDefault();
  }
  
  
  function updateProgress() {
    const progress = (currentIndex / document.querySelectorAll("#lyrics-display span").length) * 100;
    document.getElementById("progress-bar").style.width = progress + "%";
  }

  const player = document.getElementById("player");
const source = document.getElementById("video-source");
const songUrl = yourSongObject.url; // assuming this is how you get it

source.src = songUrl;
player.load();

function switchToVideo(src) {
  const videoPlayer = document.getElementById('video-player');
  const audioPlayer = document.getElementById('audio-player');

  // Stop and hide the audio player
  audioPlayer.pause();
  audioPlayer.currentTime = 0;
  audioPlayer.style.display = 'none';

  // Load and show the video
  videoPlayer.src = src;
  videoPlayer.style.display = 'block';
  videoPlayer.load();
  videoPlayer.play();

  updateBackgroundColor(song);
  
   
}

  
});
